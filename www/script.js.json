{
  "version": 3,
  "sources": [
    "lib/require.coffee",
    "coffee\\index.coffee",
    "coffee\\game.coffee",
    "coffee\\player.coffee",
    "coffee\\entities.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "Function::property = (prop, desc) ->\n    Object.defineProperty @prototype, prop, desc\n\nmoduleManager =\n    File: class File\n        constructor: (@manager, @absPath) ->\n            if not @manager.files[@absPath]?\n                throw new Error(\"file does not exist: #{@absPath}\")\n        read: -> @manager.files[@absPath]\n\n    modules: {}\n    files: {}\n    module: (name, closure) ->\n        @modules[name] =\n            closure: closure\n            instance: null\n\n    text: (name, content) ->\n        @files[name] = content\n\n    index: ->\n        @getLocation()\n        @import('/index')\n\n    getLocation: ->\n        if self.document?\n            scripts = document.getElementsByTagName 'script'\n            script = scripts[scripts.length-1]\n            @script = script.src\n        else\n            @script = self.location.href\n\n        @location = @script[...@script.lastIndexOf('/')+1]\n\n    abspath: (fromName, pathName) ->\n        if pathName == '.'\n            pathName = ''\n\n        baseName = fromName.split('/')\n        baseName.pop()\n        baseName = baseName.join('/')\n\n        if pathName[0] == '/'\n            return pathName\n        else\n            path = pathName.split '/'\n            if baseName == '/'\n                base = ['']\n            else\n                base = baseName.split '/'\n\n            while base.length > 0 and path.length > 0 and path[0] == '..'\n                base.pop()\n                path.shift()\n\n            if base.length == 0 || path.length == 0 || base[0] != ''\n                throw new Error(\"Invalid path: #{base.join '/'}/#{path.join '/'}\")\n            return \"#{base.join('/')}/#{path.join('/')}\"\n    \n    import: (moduleName) ->\n        if moduleName?\n            module = @modules[moduleName]\n\n            if module == undefined\n                module = @modules[moduleName+'/index']\n                if module?\n                    moduleName = moduleName+'/index'\n                else\n                    throw new Error('Module not found: ' + moduleName)\n            \n            if module.instance == null\n                require = (requirePath) =>\n                    path = @abspath(moduleName, requirePath)\n                    return @import(path)\n\n                exports = {}\n                sys = {\n                    script: @script\n                    location: @location\n                    import: (requirePath) =>\n                        path = @abspath(moduleName, requirePath)\n                        return @import(path)\n                    file: (path) =>\n                        path = @abspath(moduleName, path)\n                        return new @File(@, path)\n                    File: File\n                }\n                module.closure(exports, sys)\n                if exports.index?\n                    module.instance = exports.index\n                else\n                    module.instance = exports\n\n            return module.instance\n        else\n            throw new Error('no module name provided')\n",
    "Game = sys.import('game')\r\n\r\n$ ->\r\n\tconnection = new WebSocket(\"ws://#{document.location.hostname}:2503/\")\r\n\r\n\tgame = new Game()\r\n\r\n\tconnection.onmessage = ({data}) ->\r\n\t\tdata = JSON.parse(data)\r\n\t\tgame.message(data)",
    "Player = sys.import 'player'\r\nEntities = sys.import 'entities'\r\n\r\nexports.index = class Game\r\n\tconstructor: ->\r\n\t\t@sidebar = $('<div class=\"sidebar\"></div>').appendTo('body')\r\n\r\n\t\t$('<h1 class=\"allies\">My Team</h1>')\r\n\t\t\t.appendTo(@sidebar)\r\n\t\t@alliesAlive = $('<div class=\"players allies\"></div>')\r\n\t\t\t.appendTo(@sidebar)\r\n\t\t@alliesDead = $('<div class=\"players allies\"></div>')\r\n\t\t\t.appendTo(@sidebar)\r\n\r\n\t\t$('<h1 class=\"enemies\">Enemies</h1>')\r\n\t\t\t.appendTo(@sidebar)\r\n\t\t@enemiesAlive = $('<div class=\"players enemies\"></div>')\r\n\t\t\t.appendTo(@sidebar)\r\n\t\t@enemiesDead = $('<div class=\"players enemies\"></div>')\r\n\t\t\t.appendTo(@sidebar)\r\n\r\n\t\tmapdiv = $('<div class=\"map\"></div>').appendTo('body')\r\n\t\t@canvas = $('<canvas></canvas>').appendTo(mapdiv)[0]\r\n\t\t@ctx = @canvas.getContext('2d')\r\n\r\n\t\t@playersByID = {}\r\n\t\t@playersByShipID = {}\r\n\t\t@players = []\r\n\r\n\t\t@entities = new Entities(@)\r\n\r\n\t\t@raf()\r\n\r\n\tinfo: (data) ->\r\n\t\t@playersByID = {}\r\n\t\t@playersByShipID = {}\r\n\t\t@players = []\r\n\t\tif data.inMatch\r\n\t\t\t@canvas.style.backgroundImage = \"url(pkg/#{data.map.name}/minimap.png)\";\r\n\t\t\t@inMatch = true\r\n\t\t\t@mapWidth = data.map.border.high[0] - data.map.border.low[0]\r\n\t\t\t@mapHeight = data.map.border.high[2] - data.map.border.low[2]\r\n\t\t\t@mapX = data.map.border.low[0]\r\n\t\t\t@mapY = data.map.border.low[2]\r\n\t\t\tconsole.log @mapHeight\r\n\r\n\t\t\tfor playerData in data.players\r\n\t\t\t\tif playerData.team == 'ally'\r\n\t\t\t\t\tplayer = new Player(@, playerData, @alliesAlive, @alliesDead)\r\n\t\t\t\telse\r\n\t\t\t\t\tplayer = new Player(@, playerData, @enemiesAlive, @enemiesDead)\r\n\r\n\t\t\t\tif player.self\r\n\t\t\t\t\t@self = player\r\n\r\n\t\t\t\t@players.push(player)\r\n\t\t\t\t@playersByID[player.id] = player\r\n\t\t\t\t@playersByShipID[playerData.ship.id] = player\r\n\t\telse\r\n\t\t\t@canvas.style.backgroundImage = 'none';\r\n\t\t\t@inMatch = false\r\n\t\t\t@self = null\r\n\t\t\t@alliesDead.empty()\r\n\t\t\t@alliesAlive.empty()\r\n\t\t\t@enemiesDead.empty()\r\n\t\t\t@enemiesAlive.empty()\r\n\t\treturn\r\n\r\n\tmessage: (data) ->\r\n\t\tswitch data.type\r\n\t\t\twhen 'info'\r\n\t\t\t\t@info(data.data)\r\n\t\t\twhen 'update'\r\n\t\t\t\t@camera = data.data.camera\r\n\t\t\t\t@updatePlayers(data.data.players)\r\n\t\t\twhen 'entity'\r\n\t\t\t\t@entities.message(data)\r\n\r\n\tupdatePlayers: (data) ->\r\n\t\tfor item in data\r\n\t\t\tplayer = @playersByID[item.id]\r\n\t\t\tif player?\r\n\t\t\t\tplayer.update(item)\r\n\t\treturn\r\n\r\n\tdrawPlayers: ->\r\n\t\tfor player in @players\r\n\t\t\tplayer.targeted = false\r\n\r\n\t\ttargetId = @self.getTargetId()\r\n\t\ttarget = @playersByShipID[targetId]\r\n\t\tif target?\r\n\t\t\ttarget.targeted = true\r\n\t\t\ttarget.drawTargetMarker()\r\n\r\n\t\tfor player in @players\r\n\t\t\tplayer.draw()\r\n\t\treturn\r\n\r\n\tdrawBorder: ->\r\n\t\tx0 = @drawAreaX\r\n\t\ty0 = @drawAreaY\r\n\t\tx1 = x0 + @drawAreaSize\r\n\t\ty1 = y0 + @drawAreaSize\r\n\r\n\t\t@ctx.strokeStyle = 'rgba(255,255,255,0.25)'\r\n\t\t@ctx.beginPath()\r\n\t\t@ctx.moveTo(x0, y0)\r\n\t\t@ctx.lineTo(x1, y0)\r\n\t\t@ctx.lineTo(x1, y1)\r\n\t\t@ctx.lineTo(x0, y1)\r\n\t\t@ctx.closePath()\r\n\t\t@ctx.stroke()\r\n\r\n\tdrawCamera: ->\r\n\t\tif @self and @camera\r\n\t\t\t@self.drawCamera(@camera)\r\n\r\n\traf: =>\r\n\t\twidth = @canvas.clientWidth\r\n\t\theight = @canvas.clientHeight\r\n\r\n\t\tif width != @canvas.width or height != @canvas.height\r\n\t\t\t@drawAreaSize = Math.min(width, height)\r\n\t\t\t@drawAreaX = (width/2) - @drawAreaSize/2\r\n\t\t\t@drawAreaY = (height/2) - @drawAreaSize/2\r\n\r\n\t\t\t@canvas.width = width\r\n\t\t\t@canvas.height = height\r\n\r\n\t\t@width = width\r\n\t\t@height = height\r\n\r\n\t\t@ctx.clearRect(0, 0, @canvas.width, @canvas.height)\r\n\r\n\t\tif @inMatch\r\n\t\t\t@drawBorder()\r\n\t\t\t@entities.draw()\r\n\t\t\t@drawCamera()\r\n\t\t\t@drawPlayers()\r\n\r\n\t\trequestAnimationFrame(@raf)\r\n\r\n\tgetDrawX: (x) ->\r\n\t\tx = (x-@mapX)/@mapWidth\r\n\t\tx = @drawAreaX + x*@drawAreaSize\r\n\t\treturn x\r\n\r\n\tgetDrawY: (y) ->\r\n\t\ty = 1.0 - (y-@mapY)/@mapHeight\r\n\t\ty = @drawAreaY + y*@drawAreaSize\r\n\t\treturn y\r\n\r\n\ttoMapDim: (value) ->\r\n\t\treturn value * (@drawAreaSize/@mapHeight)",
    "shapes =\r\n\tCruiser: new Path2D('m -8,-4 v 8 h 3.8164062 l 3.72656255,-8 z m 9.7480469,0 -3.7265625,8 H 5 L 9,0 5,-4 Z')\r\n\tBattleship: new Path2D('m -8,-4 v 8 h 1.300781 l 3.726563,-8 z m 7.232422,0 -3.726563,8 h 2.373047 L 1.605469,-4 Z M 3.8125,-4 0.085938,4 H 5 L 9,0 5,-4 Z')\r\n\tDestroyer: new Path2D('M -5,-4 6,0 -5,4 v -8')\r\n\tAirCarrier: new Path2D('m -8,-4 v 3 H 1 V -4 Z M 3,-4 V 4 H 5 L 9,0 5,-4 Z M -8,1 V 4 H 1 V 1 Z')\r\n\tship: new Path2D('M 9,0 5,4 H -8 V -4 H 5 Z')\r\n\tself: new Path2D('M -5,-4 6,0 -5,4 -3,0 -5,-4')\r\n\r\nexports.index = class Player\r\n\tconstructor: (@game, @info, @aliveContainer, @deadContainer) ->\r\n\t\t@ctx = @game.ctx\r\n\t\t@id = @info.id\r\n\t\t@self = @info.self\r\n\t\t@alive = true\r\n\r\n\t\t@div = $('<div class=\"player\"></div>')\r\n\t\t\t.appendTo(@aliveContainer)\r\n\r\n\t\t$('<div class=\"name\"></div>')\r\n\t\t\t.appendTo(@div)\r\n\t\t\t.text(@info.name)\r\n\r\n\t\t$('<div class=\"ship\"></div>')\r\n\t\t\t.appendTo(@div)\r\n\t\t\t.text(@info.ship.name)\r\n\r\n\t\t@speedDisplay = $('<div class=\"speed\"></div>')\r\n\t\t\t.appendTo(@div)\r\n\r\n\tgetTargetId: ->\r\n\t\tif @data?\r\n\t\t\treturn @data.targeting\r\n\r\n\tdraw: ->\r\n\t\tif not @data?\r\n\t\t\treturn\r\n\r\n\t\tif not @data.spotted?\r\n\t\t\treturn\r\n\r\n\t\tx = @game.getDrawX(@data.position[0])\r\n\t\ty = @game.getDrawY(@data.position[2])\r\n\t\ts = Math.sin(@data.dir)\r\n\t\tc = Math.cos(@data.dir)\r\n\r\n\t\tif @self\r\n\t\t\t@drawSelf(x, y, s, c)\r\n\t\telse\r\n\t\t\t@drawShip(x, y, s, c)\r\n\r\n\tdrawTargetMarker: ->\r\n\t\tif @data?\r\n\t\t\tx = @game.getDrawX(@data.position[0])\r\n\t\t\ty = @game.getDrawY(@data.position[2])\r\n\t\t\ts = Math.sin(@data.dir)\r\n\t\t\tc = Math.cos(@data.dir)\r\n\r\n\t\t\t@ctx.strokeStyle = 'rgba(255,255,255,0.2)'\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.moveTo(x, y)\r\n\t\t\t@ctx.lineTo(x+s*2000, y-c*2000)\r\n\t\t\t@ctx.stroke()\r\n\r\n\t\t\tspacing = Math.PI/10\r\n\t\t\tspan = Math.PI/4 - spacing\r\n\t\t\tq = Math.PI/2\r\n\r\n\r\n\t\t\t@ctx.save()\r\n\t\t\t@ctx.translate(x, y)\r\n\t\t\t@ctx.rotate(@data.dir)\r\n\r\n\t\t\t@ctx.strokeStyle = 'rgba(255,255,255,0.8)'\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.arc(0, 0, 25, -span, span)\r\n\t\t\t@ctx.stroke()\r\n\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.arc(0, 0, 25, q-span, q+span)\r\n\t\t\t@ctx.stroke()\r\n\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.arc(0, 0, 25, 2*q-span, 2*q+span)\r\n\t\t\t@ctx.stroke()\r\n\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.arc(0, 0, 25, 3*q-span, 3*q+span)\r\n\t\t\t@ctx.stroke()\r\n\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.moveTo(14, +14)\r\n\t\t\t@ctx.lineTo(21, +21)\r\n\t\t\t@ctx.stroke()\r\n\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.moveTo(-14, -14)\r\n\t\t\t@ctx.lineTo(-21, -21)\r\n\t\t\t@ctx.stroke()\r\n\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.moveTo(+14, -14)\r\n\t\t\t@ctx.lineTo(+21, -21)\r\n\t\t\t@ctx.stroke()\r\n\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.moveTo(-14, +14)\r\n\t\t\t@ctx.lineTo(-21, +21)\r\n\t\t\t@ctx.stroke()\r\n\t\t\t@ctx.restore()\r\n\r\n\tdrawSelf: (x, y, s, c) ->\r\n\t\tif @data.alive\r\n\t\t\tcolor = 'white'\r\n\t\telse\r\n\t\t\tcolor = 'black'\r\n\r\n\t\t@ctx.strokeStyle = 'rgba(255,255,255,0.2)'\r\n\t\t@ctx.beginPath()\r\n\t\t@ctx.moveTo(x, y)\r\n\t\t@ctx.lineTo(x+s*2000, y-c*2000)\r\n\t\t@ctx.stroke()\r\n\r\n\t\t@ctx.fillStyle = color\r\n\t\tshape = shapes.self\r\n\t\t@ctx.save()\r\n\t\t@ctx.translate(x, y)\r\n\t\t@ctx.rotate(@data.dir - Math.PI/2)\r\n\t\t#@ctx.scale(10, 10)\r\n\t\t@ctx.fill(shape)\r\n\t\t@ctx.restore()\r\n\r\n\tdrawShipShape: (x, y, s, c) ->\r\n\t\tif @data.alive\r\n\t\t\tif @info.team == 'ally'\r\n\t\t\t\t@ctx.fillStyle = '#45e9af'\r\n\t\t\telse\r\n\t\t\t\tif @data.spotted\r\n\t\t\t\t\t@ctx.fillStyle = '#ff3615'\r\n\t\t\t\telse\r\n\t\t\t\t\t@ctx.fillStyle = '#ccc'\r\n\t\telse\r\n\t\t\t@ctx.fillStyle = 'rgba(0,0,0,0.5)'\r\n\r\n\t\tshape = shapes[@info.ship.type]\r\n\t\t@ctx.save()\r\n\t\t@ctx.translate(x, y)\r\n\t\t@ctx.rotate(@data.dir - Math.PI/2)\r\n\t\t#@ctx.scale(10, 10)\r\n\t\t@ctx.fill(shape)\r\n\t\t@ctx.restore()\r\n\r\n\tdrawShipExtra: (x, y, s, c) ->\r\n\t\tif @data.alive\r\n\t\t\tif @info.team == 'ally'\r\n\t\t\t\t@ctx.fillStyle = '#45e9af'\r\n\t\t\telse\r\n\t\t\t\t@ctx.fillStyle = '#ff3615'\r\n\t\t\t\t\r\n\t\t\t@ctx.save()\r\n\t\t\t@ctx.globalAlpha = 0.8\r\n\t\t\t@ctx.textAlign = 'center'\r\n\t\t\t@ctx.font = '500 9px \"Nobile\"'\r\n\t\t\t@ctx.fillText(@info.ship.short, Math.round(x), Math.round(y+18))\r\n\t\t\t@ctx.restore()\r\n\r\n\t\t\t@ctx.strokeStyle = 'rgba(255,255,255,0.2)'\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.moveTo(x, y)\r\n\t\t\t@ctx.lineTo(x+s*30, y-c*30)\r\n\t\t\t@ctx.stroke()\r\n\r\n\tdrawShip: (x, y, s, c) ->\r\n\t\t@drawShipShape(x, y, s, c)\r\n\t\t@drawShipExtra(x, y, s, c)\r\n\r\n\tdrawCamera: (camera) ->\r\n\t\tif @data\r\n\t\t\tx = @game.getDrawX(@data.position[0])\r\n\t\t\ty = @game.getDrawY(@data.position[2])\r\n\r\n\t\t\t[dx,dy,dz] = camera.dir\r\n\t\t\t@ctx.strokeStyle = 'rgba(255,255,255,0.5)'\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.moveTo(x,y)\r\n\t\t\t@ctx.lineTo(x+dx*1000, y-dz*1000)\r\n\t\t\t@ctx.stroke()\r\n\r\n\tdied: ->\r\n\t\t@div.addClass('dead')\r\n\t\t@div.appendTo(@deadContainer)\r\n\r\n\tupdate: (@data) ->\r\n\t\tif not @data.alive\r\n\t\t\t@alive = false\r\n\t\t\t@died()\r\n\r\n\t\tif @data.visible\r\n\t\t\t@speedDisplay.removeClass('hidden')\r\n\t\telse\r\n\t\t\t@speedDisplay.addClass('hidden')\r\n\r\n\t\t@speedDisplay.text @data.speed.toFixed(0) + ' kts'\r\n\t\tif @targeted\r\n\t\t\t@div.addClass('targeted')\r\n\t\telse\r\n\t\t\t@div.removeClass('targeted')",
    "entityTypes =\r\n\tsmoke: class SmokeScreen\r\n\t\tconstructor: (@game, data) ->\r\n\t\t\t@ctx = @game.ctx\r\n\t\t\t@radius = data.data.radius\r\n\r\n\t\t\t[r,g,b] = [5,32,53]\r\n\t\t\tf = 0.2\r\n\t\t\tr = Math.round(r*(1-f)+255*f).toFixed(0)\r\n\t\t\tg = Math.round(g*(1-f)+255*f).toFixed(0)\r\n\t\t\tb = Math.round(b*(1-f)+255*f).toFixed(0)\r\n\t\t\t#@color = \"rgb(#{r}, #{g}, #{b})\"\r\n\t\t\t@color = 'rgba(255,255,255,0.1)'\r\n\r\n\r\n\t\tdraw: ->\r\n\t\t\tif @points?\r\n\t\t\t\t@ctx.save()\r\n\t\t\t\t@ctx.fillStyle = @color\r\n\t\t\t\tfor [x,y] in @points\r\n\t\t\t\t\tx = @game.getDrawX(x)\r\n\t\t\t\t\ty = @game.getDrawY(y)\r\n\r\n\t\t\t\t\t@ctx.beginPath()\r\n\t\t\t\t\t@ctx.arc(x, y, @radius, 0, Math.PI*2)\r\n\t\t\t\t\t@ctx.fill()\r\n\t\t\t\t@ctx.restore()\r\n\r\n\t\tupdate: (data) ->\r\n\t\t\t@points = data.data\r\n\r\n\tshot: class Shot\r\n\t\tconstructor: (@game, data) ->\r\n\t\t\t@ctx = @game.ctx\r\n\t\t\t@data = data.data\r\n\t\t\t@startTime = performance.now()/1000\r\n\t\t\t\r\n\t\tdraw: ->\r\n\t\t\t#offset = @game.mapHeight*(70/800)\r\n\t\t\tx0 = @game.getDrawX(@data.origin[0])\r\n\t\t\ty0 = @game.getDrawY(@data.origin[2])\r\n\t\t\tx1 = @game.getDrawX(@data.target[0])\r\n\t\t\ty1 = @game.getDrawY(@data.target[2])\r\n\r\n\t\t\txd = @data.dir[0]\r\n\t\t\tyd = -@data.dir[2]\r\n\t\t\tl = Math.sqrt(xd*xd + yd*yd)\r\n\t\t\txd/=l\r\n\t\t\tyd/=l\r\n\t\t\tdist = @game.toMapDim(@data.distance)\r\n\r\n\t\t\t###\r\n\t\t\t@ctx.save()\r\n\t\t\t@ctx.strokeStyle = 'red'\r\n\t\t\t#@ctx.strokeStyle = 'rgba(255,255,255,0.1)'\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.moveTo(x0, y0+2)\r\n\t\t\t@ctx.lineTo(x1, y1+2)\r\n\t\t\t@ctx.stroke()\r\n\t\t\t@ctx.restore()\r\n\t\t\t###\r\n\r\n\t\t\t@ctx.save()\r\n\t\t\t#@ctx.strokeStyle = 'green'\r\n\t\t\t@ctx.strokeStyle = 'rgba(255,255,255,0.1)'\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.moveTo(x0, y0)\r\n\t\t\t@ctx.lineTo(x0+xd*dist, y0+yd*dist)\r\n\t\t\t@ctx.stroke()\r\n\t\t\t@ctx.restore()\r\n\r\n\t\t\tnow = performance.now()/1000\r\n\t\t\tf = (now - @startTime)/(@data.time+0.4)\r\n\t\t\t#x = x0 + xd*dist*f\r\n\t\t\t#y = y0 + yd*dist*f\r\n\t\t\tx = x0*(1-f) + x1*f\r\n\t\t\ty = y0*(1-f) + y1*f\r\n\r\n\t\t\tif @data.type == 'AP'\r\n\t\t\t\t@ctx.fillStyle = '#57aeff'\r\n\t\t\telse\r\n\t\t\t\t@ctx.fillStyle = 'red'\r\n\t\t\t@ctx.beginPath()\r\n\t\t\t@ctx.arc(x, y, 1, 0, Math.PI*2)\r\n\t\t\t@ctx.fill()\r\n\t\t\t@ctx.fill()\r\n\r\n\t\tupdate: ->\r\n\t\t\tnull\r\n\r\nexports.index = class Entities\r\n\tconstructor: (@game) ->\r\n\t\tconsole.log 'here'\r\n\t\t@entities = {}\r\n\r\n\tmessage: (data) ->\r\n\t\tswitch data.action\r\n\t\t\twhen 'create'\r\n\t\t\t\t@entities[data.id] = new entityTypes[data.entityType](@game, data)\r\n\t\t\twhen 'update'\r\n\t\t\t\t@entities[data.id].update(data)\r\n\t\t\twhen 'remove'\r\n\t\t\t\tdelete @entities[data.id]\r\n\r\n\tdraw: ->\r\n\t\tfor id, entity of @entities\r\n\t\t\tentity.draw()\r\n"
  ],
  "sourceRoot": ".."
}